{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/DELL/Documents/AEGIS/frontend/src/components/ProtectedRoute.tsx"],"sourcesContent":["\"use client\";\r\nimport { useAuth } from \"@/context/AuthContext\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useEffect } from \"react\";\r\n\r\ninterface ProtectedRouteProps {\r\n    children: React.ReactNode;\r\n    allowedRoles?: string[];\r\n}\r\n\r\nconst ProtectedRoute: React.FC<ProtectedRouteProps> = ({ children, allowedRoles }) => {\r\n    const { user, loading, role } = useAuth();\r\n    const router = useRouter();\r\n\r\n    useEffect(() => {\r\n        if (!loading && !user) {\r\n            router.push(\"/login\");\r\n        } else if (!loading && user && allowedRoles && !allowedRoles.includes(role || 'student')) {\r\n            // Redirect to unauthorized page if role doesn't match\r\n            router.push(\"/unauthorized\");\r\n        }\r\n    }, [user, loading, role, allowedRoles, router]);\r\n\r\n    if (loading) {\r\n        return <div className=\"flex items-center justify-center min-h-screen\">Loading authentication...</div>;\r\n    }\r\n\r\n    // If check fails, returing null prevents flash of content before redirect executes\r\n    if (!user || (allowedRoles && !allowedRoles.includes(role || 'student'))) {\r\n        return null;\r\n    }\r\n\r\n    return <>{children}</>;\r\n};\r\n\r\nexport default ProtectedRoute;\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;AAHA;;;;AAUA,MAAM,iBAAgD,CAAC,EAAE,QAAQ,EAAE,YAAY,EAAE;;IAC7E,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,IAAA,4IAAO;IACvC,MAAM,SAAS,IAAA,kJAAS;IAExB,IAAA,0KAAS;oCAAC;YACN,IAAI,CAAC,WAAW,CAAC,MAAM;gBACnB,OAAO,IAAI,CAAC;YAChB,OAAO,IAAI,CAAC,WAAW,QAAQ,gBAAgB,CAAC,aAAa,QAAQ,CAAC,QAAQ,YAAY;gBACtF,sDAAsD;gBACtD,OAAO,IAAI,CAAC;YAChB;QACJ;mCAAG;QAAC;QAAM;QAAS;QAAM;QAAc;KAAO;IAE9C,IAAI,SAAS;QACT,qBAAO,6LAAC;YAAI,WAAU;sBAAgD;;;;;;IAC1E;IAEA,mFAAmF;IACnF,IAAI,CAAC,QAAS,gBAAgB,CAAC,aAAa,QAAQ,CAAC,QAAQ,YAAa;QACtE,OAAO;IACX;IAEA,qBAAO;kBAAG;;AACd;GAvBM;;QAC8B,4IAAO;QACxB,kJAAS;;;KAFtB;uCAyBS"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///D:/DELL/Documents/AEGIS/frontend/src/app/grievances/submit/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { storage } from '@/lib/firebase';\r\nimport { ref, uploadBytes, getDownloadURL } from 'firebase/storage';\r\nimport ProtectedRoute from '@/components/ProtectedRoute';\r\n\r\nexport default function SubmitGrievancePage() {\r\n    const { user } = useAuth();\r\n    const router = useRouter();\r\n    const [loading, setLoading] = useState(false);\r\n    const [file, setFile] = useState<File | null>(null);\r\n    const [formData, setFormData] = useState({\r\n        category: 'Infrastructure',\r\n        priority: 'Medium',\r\n        location: '',\r\n        description: '',\r\n        isAnonymous: false\r\n    });\r\n\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {\r\n        const { name, value } = e.target;\r\n        // @ts-ignore\r\n        setFormData(prev => ({ ...prev, [name]: value }));\r\n    };\r\n\r\n    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        if (e.target.files && e.target.files[0]) {\r\n            setFile(e.target.files[0]);\r\n        }\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setLoading(true);\r\n\r\n        try {\r\n            let photoUrl = '';\r\n\r\n            if (file) {\r\n                const storageRef = ref(storage, `grievances/${Date.now()}_${file.name}`);\r\n                const snapshot = await uploadBytes(storageRef, file);\r\n                photoUrl = await getDownloadURL(snapshot.ref);\r\n            }\r\n\r\n            const token = await user?.getIdToken();\r\n            const response = await fetch(`${process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5000/api'}/grievances/submit`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `Bearer ${token}`\r\n                },\r\n                body: JSON.stringify({\r\n                    ...formData,\r\n                    photoUrl\r\n                })\r\n            });\r\n\r\n            if (!response.ok) throw new Error('Failed to submit grievance');\r\n\r\n            router.push('/grievances'); // Redirect to tracking page\r\n        } catch (error) {\r\n            console.error(error);\r\n            alert('Error submitting grievance. Please try again.');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <ProtectedRoute allowedRoles={['student']}>\r\n            <div className=\"max-w-3xl mx-auto py-10 animate-in fade-in-50\">\r\n                <div className=\"mb-8 text-center space-y-4\">\r\n                    <div className=\"p-3 bg-gradient-to-br from-rose-500/20 to-orange-500/20 w-fit mx-auto rounded-2xl border border-white/10 backdrop-blur-xl\">\r\n                        <AlertTriangle className=\"w-10 h-10 text-rose-400\" />\r\n                    </div>\r\n                    <div>\r\n                        <h1 className=\"text-3xl font-bold tracking-tight text-white\">Submit a Grievance</h1>\r\n                        <p className=\"text-slate-400 mt-2 max-w-lg mx-auto\">Found an issue on campus? Report it here and we'll track it until resolution.</p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"aegis-card p-8 relative overflow-hidden\">\r\n                    <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-rose-500 via-orange-500 to-rose-500\"></div>\r\n\r\n                    <form onSubmit={handleSubmit} className=\"space-y-8\">\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-sm font-medium text-slate-300 ml-1\">Category</label>\r\n                                <div className=\"relative\">\r\n                                    <select\r\n                                        name=\"category\"\r\n                                        value={formData.category}\r\n                                        onChange={handleChange}\r\n                                        className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white appearance-none focus:outline-none focus:ring-2 focus:ring-rose-500/50 focus:border-rose-500/50 transition-all\"\r\n                                    >\r\n                                        <option className=\"bg-slate-900 text-white\">Infrastructure</option>\r\n                                        <option className=\"bg-slate-900 text-white\">Academic</option>\r\n                                        <option className=\"bg-slate-900 text-white\">Administrative</option>\r\n                                        <option className=\"bg-slate-900 text-white\">Hostel</option>\r\n                                        <option className=\"bg-slate-900 text-white\">Transport</option>\r\n                                        <option className=\"bg-slate-900 text-white\">Other</option>\r\n                                    </select>\r\n                                    <div className=\"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none\">\r\n                                        <ChevronDown className=\"w-4 h-4 text-slate-400\" />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-sm font-medium text-slate-300 ml-1\">Priority</label>\r\n                                <div className=\"relative\">\r\n                                    <select\r\n                                        name=\"priority\"\r\n                                        value={formData.priority}\r\n                                        onChange={handleChange}\r\n                                        className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white appearance-none focus:outline-none focus:ring-2 focus:ring-rose-500/50 focus:border-rose-500/50 transition-all\"\r\n                                    >\r\n                                        <option className=\"bg-slate-900 text-white\">Low</option>\r\n                                        <option className=\"bg-slate-900 text-white\">Medium</option>\r\n                                        <option className=\"bg-slate-900 text-white\">High</option>\r\n                                        <option className=\"bg-slate-900 text-white\">Urgent</option>\r\n                                    </select>\r\n                                    <div className=\"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none\">\r\n                                        <ChevronDown className=\"w-4 h-4 text-slate-400\" />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-sm font-medium text-slate-300 ml-1\">Location</label>\r\n                            <div className=\"relative\">\r\n                                <MapPin className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-500\" />\r\n                                <input\r\n                                    type=\"text\"\r\n                                    name=\"location\"\r\n                                    required\r\n                                    value={formData.location}\r\n                                    onChange={handleChange}\r\n                                    placeholder=\"e.g. Library 2nd Floor, Room 301\"\r\n                                    className=\"w-full bg-white/5 border border-white/10 rounded-xl pl-12 pr-4 py-3 text-white placeholder:text-slate-600 focus:outline-none focus:ring-2 focus:ring-rose-500/50 focus:border-rose-500/50 transition-all font-medium\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-sm font-medium text-slate-300 ml-1\">Description</label>\r\n                            <textarea\r\n                                name=\"description\"\r\n                                required\r\n                                rows={5}\r\n                                value={formData.description}\r\n                                onChange={handleChange}\r\n                                placeholder=\"Please provide detailed information about the issue...\"\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-xl p-4 text-white placeholder:text-slate-600 focus:outline-none focus:ring-2 focus:ring-rose-500/50 focus:border-rose-500/50 transition-all resize-none\"\r\n                            ></textarea>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-sm font-medium text-slate-300 ml-1\">Evidence (Optional)</label>\r\n                            <div className=\"border-2 border-dashed border-white/10 rounded-xl p-8 text-center hover:border-rose-500/30 hover:bg-white/5 transition-all cursor-pointer group relative\">\r\n                                <input\r\n                                    type=\"file\"\r\n                                    accept=\"image/*\"\r\n                                    onChange={handleFileChange}\r\n                                    className=\"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10\"\r\n                                />\r\n                                <div className=\"flex flex-col items-center justify-center gap-3\">\r\n                                    <div className=\"p-3 bg-white/5 rounded-full text-slate-400 group-hover:text-rose-400 transition-colors\">\r\n                                        <Upload className=\"w-6 h-6\" />\r\n                                    </div>\r\n                                    <div className=\"text-sm text-slate-400\">\r\n                                        {file ? (\r\n                                            <span className=\"text-rose-400 font-medium\">{file.name}</span>\r\n                                        ) : (\r\n                                            <>\r\n                                                <span className=\"font-medium text-white group-hover:text-rose-300 transition-colors\">Click to upload</span> or drag and drop\r\n                                            </>\r\n                                        )}\r\n                                    </div>\r\n                                    <p className=\"text-xs text-slate-600\">SVG, PNG, JPG or GIF (MAX. 5MB)</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex items-center gap-3 bg-white/5 p-4 rounded-xl border border-white/5\">\r\n                            <div className=\"relative flex items-center\">\r\n                                <input\r\n                                    type=\"checkbox\"\r\n                                    name=\"isAnonymous\"\r\n                                    id=\"isAnonymous\"\r\n                                    checked={formData.isAnonymous}\r\n                                    onChange={(e) => setFormData(prev => ({ ...prev, isAnonymous: e.target.checked }))}\r\n                                    className=\"peer h-5 w-5 cursor-pointer appearance-none rounded-md border border-white/10 bg-slate-900 checked:border-rose-500 checked:bg-rose-500 transition-all\"\r\n                                />\r\n                                <Check className=\"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-3.5 h-3.5 text-white opacity-0 peer-checked:opacity-100 pointer-events-none transition-opacity\" />\r\n                            </div>\r\n                            <label htmlFor=\"isAnonymous\" className=\"text-sm font-medium text-slate-300 cursor-pointer select-none\">\r\n                                Submit Anonymously <span className=\"text-slate-500 font-normal ml-1\">(Your name will be hidden from authorities)</span>\r\n                            </label>\r\n                        </div>\r\n\r\n                        <Button\r\n                            type=\"submit\"\r\n                            disabled={loading}\r\n                            className=\"w-full bg-gradient-to-r from-rose-600 to-orange-600 hover:from-rose-500 hover:to-orange-500 text-white font-bold py-4 rounded-xl shadow-lg shadow-rose-900/20 disabled:opacity-50 transition-all hover:scale-[1.01] active:scale-[0.99]\"\r\n                        >\r\n                            {loading ? (\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <div className=\"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin\" />\r\n                                    Submitting...\r\n                                </div>\r\n                            ) : (\r\n                                <span className=\"flex items-center gap-2\">\r\n                                    Submit Grievance <ArrowRight className=\"w-5 h-5\" />\r\n                                </span>\r\n                            )}\r\n                        </Button>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        </ProtectedRoute>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}