{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/DELL/Documents/AEGIS/frontend/src/components/ProtectedRoute.tsx"],"sourcesContent":["\"use client\";\r\nimport { useAuth } from \"@/context/AuthContext\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useEffect } from \"react\";\r\n\r\ninterface ProtectedRouteProps {\r\n    children: React.ReactNode;\r\n    allowedRoles?: string[];\r\n}\r\n\r\nconst ProtectedRoute: React.FC<ProtectedRouteProps> = ({ children, allowedRoles }) => {\r\n    const { user, loading, role } = useAuth();\r\n    const router = useRouter();\r\n\r\n    useEffect(() => {\r\n        if (!loading && !user) {\r\n            router.push(\"/login\");\r\n        } else if (!loading && user && allowedRoles && !allowedRoles.includes(role || 'student')) {\r\n            // Redirect to unauthorized page if role doesn't match\r\n            router.push(\"/unauthorized\");\r\n        }\r\n    }, [user, loading, role, allowedRoles, router]);\r\n\r\n    if (loading) {\r\n        return <div className=\"flex items-center justify-center min-h-screen\">Loading authentication...</div>;\r\n    }\r\n\r\n    // If check fails, returing null prevents flash of content before redirect executes\r\n    if (!user || (allowedRoles && !allowedRoles.includes(role || 'student'))) {\r\n        return null;\r\n    }\r\n\r\n    return <>{children}</>;\r\n};\r\n\r\nexport default ProtectedRoute;\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAHA;;;;;AAUA,MAAM,iBAAgD,CAAC,EAAE,QAAQ,EAAE,YAAY,EAAE;IAC7E,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,IAAA,yIAAO;IACvC,MAAM,SAAS,IAAA,+IAAS;IAExB,IAAA,kNAAS,EAAC;QACN,IAAI,CAAC,WAAW,CAAC,MAAM;YACnB,OAAO,IAAI,CAAC;QAChB,OAAO,IAAI,CAAC,WAAW,QAAQ,gBAAgB,CAAC,aAAa,QAAQ,CAAC,QAAQ,YAAY;YACtF,sDAAsD;YACtD,OAAO,IAAI,CAAC;QAChB;IACJ,GAAG;QAAC;QAAM;QAAS;QAAM;QAAc;KAAO;IAE9C,IAAI,SAAS;QACT,qBAAO,8OAAC;YAAI,WAAU;sBAAgD;;;;;;IAC1E;IAEA,mFAAmF;IACnF,IAAI,CAAC,QAAS,gBAAgB,CAAC,aAAa,QAAQ,CAAC,QAAQ,YAAa;QACtE,OAAO;IACX;IAEA,qBAAO;kBAAG;;AACd;uCAEe"}},
    {"offset": {"line": 57, "column": 0}, "map": {"version":3,"sources":["file:///D:/DELL/Documents/AEGIS/frontend/src/app/grievances/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport ProtectedRoute from '@/components/ProtectedRoute';\r\n\r\nexport default function GrievanceDetailsPage({ params }: { params: { id: string } }) {\r\n    const { user } = useAuth();\r\n    const router = useRouter();\r\n    const [grievance, setGrievance] = useState<any>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState('');\r\n\r\n    useEffect(() => {\r\n        const fetchGrievance = async () => {\r\n            if (!user) return;\r\n            const grievanceId = await params.id; // Correct way to access params in Next.js 15+ if simplified, but here it's likely sync. Let's assume passed prop.\r\n            // Actually, params is a promise in newer Next.js versions often, but here it seems typed as { id: string }.\r\n            // Let's stick to standard access.\r\n\r\n            try {\r\n                const token = await user.getIdToken();\r\n                // Ideally, we should have a GET /:id endpoint. \r\n                // Using List for now as per current backend architecture.\r\n                const response = await fetch(`${process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5000/api'}/grievances/list`, {\r\n                    headers: { 'Authorization': `Bearer ${token}` }\r\n                });\r\n\r\n                if (!response.ok) throw new Error('Failed to fetch grievance');\r\n\r\n                const data = await response.json();\r\n                const found = data.find((g: any) => g.grievanceId === grievanceId);\r\n\r\n                if (found) {\r\n                    setGrievance(found);\r\n                } else {\r\n                    setError('Grievance not found or access denied.');\r\n                }\r\n\r\n            } catch (err: any) {\r\n                console.error(err);\r\n                setError(err.message);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchGrievance();\r\n    }, [user, params.id]);\r\n\r\n    if (loading) return <div className=\"p-10 text-center\">Loading details...</div>;\r\n    if (error) return <div className=\"p-10 text-center text-red-500\">{error}</div>;\r\n    if (!grievance) return <div className=\"p-10 text-center\">Grievance not found.</div>;\r\n\r\n    const getStatusColor = (status: string) => {\r\n        switch (status) {\r\n            case 'Resolved': return 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400';\r\n            case 'In Progress': return 'bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400';\r\n            case 'Review': return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400';\r\n            default: return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\r\n        }\r\n    };\r\n\r\n    return (\r\n        <ProtectedRoute allowedRoles={['student', 'authority', 'admin']}>\r\n            <div className=\"max-w-4xl mx-auto py-10 px-4\">\r\n                <button onClick={() => router.back()} className=\"mb-6 text-blue-600 hover:underline\">‚Üê Back</button>\r\n\r\n                <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow border border-gray-200 dark:border-gray-700 overflow-hidden\">\r\n                    <div className=\"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-start\">\r\n                        <div>\r\n                            <div className=\"flex items-center space-x-3 mb-2\">\r\n                                <span className={`px-3 py-1 rounded-full text-xs font-semibold uppercase tracking-wide ${getStatusColor(grievance.status)}`}>\r\n                                    {grievance.status}\r\n                                </span>\r\n                                <span className=\"text-sm text-gray-500\">\r\n                                    Submitted on {grievance.createdAt?._seconds ? new Date(grievance.createdAt._seconds * 1000).toLocaleDateString() : 'N/A'}\r\n                                </span>\r\n                            </div>\r\n                            <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n                                {grievance.category} Issue\r\n                            </h1>\r\n                            <p className=\"text-gray-600 dark:text-gray-300 mt-1\">Location: {grievance.location}</p>\r\n                        </div>\r\n                        <div className=\"text-right\">\r\n                            <span className={`inline-block px-3 py-1 rounded-md text-sm font-medium ${grievance.priority === 'Urgent' ? 'bg-red-100 text-red-800' :\r\n                                grievance.priority === 'High' ? 'bg-orange-100 text-orange-800' : 'bg-gray-100 text-gray-800'\r\n                                }`}>\r\n                                {grievance.priority} Priority\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"p-6 space-y-6\">\r\n                        <div>\r\n                            <h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2\">Description</h3>\r\n                            <p className=\"text-gray-900 dark:text-white whitespace-pre-wrap\">{grievance.description}</p>\r\n                        </div>\r\n\r\n                        {grievance.photoUrl && (\r\n                            <div>\r\n                                <h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2\">Photo Evidence</h3>\r\n                                <img src={grievance.photoUrl} alt=\"Grievance Evidence\" className=\"max-w-md rounded-lg border border-gray-200 dark:border-gray-700\" />\r\n                            </div>\r\n                        )}\r\n\r\n                        <div>\r\n                            <h3 className=\"text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2\">Timeline</h3>\r\n                            <div className=\"space-y-4\">\r\n                                {grievance.timeline && grievance.timeline.map((event: any, index: number) => (\r\n                                    <div key={index} className=\"flex gap-4\">\r\n                                        <div className=\"flex flex-col items-center\">\r\n                                            <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2\"></div>\r\n                                            {index < grievance.timeline.length - 1 && <div className=\"w-0.5 bg-gray-200 dark:bg-gray-700 flex-1 h-full min-h-[20px]\"></div>}\r\n                                        </div>\r\n                                        <div className=\"pb-4\">\r\n                                            <p className=\"text-sm font-medium text-gray-900 dark:text-white\">{event.status}</p>\r\n                                            <p className=\"text-xs text-gray-500\">{event.timestamp ? new Date(event.timestamp).toLocaleString() : 'N/A'}</p>\r\n                                            <p className=\"text-sm text-gray-600 dark:text-gray-300 mt-1\">{event.remark}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </ProtectedRoute>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}