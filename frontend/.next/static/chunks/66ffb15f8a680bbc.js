(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,11870,e=>{"use strict";var r=e.i(43476),t=e.i(32341),a=e.i(18566),s=e.i(71645);e.s(["default",0,({children:e,allowedRoles:l})=>{let{user:o,loading:d,role:i}=(0,t.useAuth)(),u=(0,a.useRouter)();return((0,s.useEffect)(()=>{d||o?!d&&o&&l&&!l.includes(i||"student")&&u.push("/unauthorized"):u.push("/login")},[o,d,i,l,u]),d)?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:"Loading authentication..."}):o&&(!l||l.includes(i||"student"))?(0,r.jsx)(r.Fragment,{children:e}):null}])},28895,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(18566),s=e.i(32341),l=e.i(11870),o=e.i(59141);e.i(61086);var d=e.i(27215);function i(){let{user:e,role:i}=(0,s.useAuth)(),u=(0,a.useRouter)(),[n,c]=(0,t.useState)(!1),[m,g]=(0,t.useState)(null),[b,f]=(0,t.useState)({title:"",description:"",courseId:"",resourceType:"Notes",tags:""}),x=e=>{let{name:r,value:t}=e.target;f(e=>({...e,[r]:t}))},h=async r=>{if(r.preventDefault(),!m)return void alert("Please select a file to upload.");c(!0);try{let r=(0,d.ref)(o.storage,`resources/${Date.now()}_${m.name}`),t=await (0,d.uploadBytes)(r,m),a=await (0,d.getDownloadURL)(t.ref),s=await e?.getIdToken();if(!(await fetch("http://localhost:5000/api/academic/upload",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({...b,courseId:b.courseId.toUpperCase(),tags:b.tags.split(",").map(e=>e.trim()),fileUrl:a})})).ok)throw Error("Failed to upload resource metadata");alert("Resource uploaded successfully!"),u.push("/dashboard")}catch(e){console.error(e),alert("Error processing upload. Please try again.")}finally{c(!1)}};return(0,r.jsx)(l.default,{allowedRoles:["faculty","admin"],children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto py-10",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-6 text-gray-900 dark:text-white",children:"Upload Academic Resource"}),(0,r.jsxs)("form",{onSubmit:h,className:"space-y-6 bg-white dark:bg-gray-800 p-8 rounded-xl shadow-md border border-gray-200 dark:border-gray-700",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Title"}),(0,r.jsx)("input",{type:"text",name:"title",required:!0,value:b.title,onChange:x,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 p-2",placeholder:"e.g. Data Structures Lecture 1"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Course Code"}),(0,r.jsx)("input",{type:"text",name:"courseId",required:!0,value:b.courseId,onChange:x,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 p-2",placeholder:"e.g. CS101"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Resource Type"}),(0,r.jsxs)("select",{name:"resourceType",value:b.resourceType,onChange:x,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 p-2",children:[(0,r.jsx)("option",{children:"Notes"}),(0,r.jsx)("option",{children:"Paper"}),(0,r.jsx)("option",{children:"Slides"}),(0,r.jsx)("option",{children:"Assignment"}),(0,r.jsx)("option",{children:"Other"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),(0,r.jsx)("textarea",{name:"description",rows:3,value:b.description,onChange:x,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 p-2"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"File Upload (Max 50MB)"}),(0,r.jsx)("input",{type:"file",required:!0,onChange:e=>{if(e.target.files&&e.target.files[0]){let r=e.target.files[0];if(r.size>0x3200000)return void alert("File size exceeds 50MB limit.");g(r)}},className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 dark:file:bg-gray-700 dark:file:text-gray-300"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Tags (comma separated)"}),(0,r.jsx)("input",{type:"text",name:"tags",value:b.tags,onChange:x,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 p-2",placeholder:"e.g. recursion, sorting, midterm"})]}),(0,r.jsx)("button",{type:"submit",disabled:n,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:n?"Uploading...":"Upload Resource"})]})]})})}e.s(["default",()=>i])}]);