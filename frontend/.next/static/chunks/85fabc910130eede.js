(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,11870,e=>{"use strict";var t=e.i(43476),s=e.i(32341),l=e.i(18566),r=e.i(71645);e.s(["default",0,({children:e,allowedRoles:a})=>{let{user:i,loading:n,role:c}=(0,s.useAuth)(),o=(0,l.useRouter)();return((0,r.useEffect)(()=>{n||i?!n&&i&&a&&!a.includes(c||"student")&&o.push("/unauthorized"):o.push("/login")},[i,n,c,a,o]),n)?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:"Loading authentication..."}):i&&(!a||a.includes(c||"student"))?(0,t.jsx)(t.Fragment,{children:e}):null}])},2747,e=>{"use strict";var t=e.i(43476),s=e.i(75157);function l({className:e,...l}){return(0,t.jsx)("div",{className:(0,s.cn)("animate-pulse rounded-md bg-muted",e),...l})}e.s(["Skeleton",()=>l])},87130,e=>{"use strict";let t=(0,e.i(75254).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>t],87130)},3116,e=>{"use strict";let t=(0,e.i(75254).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>t],3116)},61653,e=>{"use strict";let t=(0,e.i(75254).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["default",()=>t])},63209,e=>{"use strict";var t=e.i(61653);e.s(["AlertCircle",()=>t.default])},81140,34620,e=>{"use strict";function t(e,s,{checkForDefaultPrevented:l=!0}={}){return function(t){if(e?.(t),!1===l||!t.defaultPrevented)return s?.(t)}}"u">typeof window&&window.document&&window.document.createElement,e.s(["composeEventHandlers",()=>t],81140);var s=e.i(71645),l=globalThis?.document?s.useLayoutEffect:()=>{};e.s(["useLayoutEffect",()=>l],34620)},35804,e=>{"use strict";var t=e.i(71645),s=e.i(34620);function l(e){let[l,r]=t.useState(void 0);return(0,s.useLayoutEffect)(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let s,l;if(!Array.isArray(t)||!t.length)return;let a=t[0];if("borderBoxSize"in a){let e=a.borderBoxSize,t=Array.isArray(e)?e[0]:e;s=t.inlineSize,l=t.blockSize}else s=e.offsetWidth,l=e.offsetHeight;r({width:s,height:l})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}r(void 0)},[e]),l}e.s(["useSize",()=>l])},69340,99682,e=>{"use strict";var t=e.i(71645),s=e.i(34620);t[" useEffectEvent ".trim().toString()],t[" useInsertionEffect ".trim().toString()];var l=t[" useInsertionEffect ".trim().toString()]||s.useLayoutEffect;function r({prop:e,defaultProp:s,onChange:r=()=>{},caller:a}){let[i,n,c]=function({defaultProp:e,onChange:s}){let[r,a]=t.useState(e),i=t.useRef(r),n=t.useRef(s);return l(()=>{n.current=s},[s]),t.useEffect(()=>{i.current!==r&&(n.current?.(r),i.current=r)},[r,i]),[r,a,n]}({defaultProp:s,onChange:r}),o=void 0!==e,d=o?e:i;{let s=t.useRef(void 0!==e);t.useEffect(()=>{let e=s.current;if(e!==o){let t=o?"controlled":"uncontrolled";console.warn(`${a} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}s.current=o},[o,a])}return[d,t.useCallback(t=>{if(o){let s="function"==typeof t?t(e):t;s!==e&&c.current?.(s)}else n(t)},[o,e,n,c])]}function a(e){let s=t.useRef({value:e,previous:e});return t.useMemo(()=>(s.current.value!==e&&(s.current.previous=s.current.value,s.current.value=e),s.current.previous),[e])}Symbol("RADIX:SYNC_STATE"),e.s(["useControllableState",()=>r],69340),e.s(["usePrevious",()=>a],99682)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},64659,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["ChevronDown",()=>t],64659)},86536,e=>{"use strict";let t=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],86536)},42412,e=>{"use strict";var t=e.i(43476),s=e.i(71645),l=e.i(18566),r=e.i(22016),a=e.i(32341),i=e.i(11870),n=e.i(19455),c=e.i(87486),o=e.i(93479),d=e.i(2747),u=e.i(67489),h=e.i(55436),x=e.i(87130),m=e.i(63209),g=e.i(3116),f=e.i(86536),v=e.i(16715);function w(){let{user:e}=(0,a.useAuth)(),w=(0,l.useSearchParams)(),[b,p]=(0,s.useState)([]),[j,y]=(0,s.useState)([]),[N,S]=(0,s.useState)(!0),[A,k]=(0,s.useState)(null),[C,I]=(0,s.useState)(w.get("status")||"All"),[R,E]=(0,s.useState)(w.get("priority")||"All"),[z,B]=(0,s.useState)("All"),[L,T]=(0,s.useState)(""),P=async()=>{if(e){S(!0);try{let t=await e.getIdToken(),s=await fetch("http://localhost:5000/api/grievances/list",{headers:{Authorization:`Bearer ${t}`}});if(!s.ok)throw Error("Failed to fetch grievances");let l=await s.json();p(l),y(l)}catch(e){console.error(e)}finally{S(!1)}}};(0,s.useEffect)(()=>{P()},[e]),(0,s.useEffect)(()=>{let e=[...b];"All"!==C&&(e=e.filter(e=>e.status===C)),"All"!==R&&(e=e.filter(e=>e.priority===R)),"All"!==z&&(e=e.filter(e=>e.category===z)),L&&(e=e.filter(e=>e.description?.toLowerCase().includes(L.toLowerCase())||e.grievanceId?.toLowerCase().includes(L.toLowerCase())||e.location?.toLowerCase().includes(L.toLowerCase()))),y(e)},[C,R,z,L,b]);let U=async(t,s)=>{let l=prompt(`Enter remark for updating status to ${s}:`);if(!l||""===l.trim())return void alert("Remark is required for status updates.");k(t);try{let r=await e?.getIdToken();if(!(await fetch(`http://localhost:5000/api/grievances/${t}/status`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({status:s,remark:l})})).ok)throw Error("Failed to update status");alert("Status updated successfully"),P()}catch(e){console.error(e),alert("Error updating status")}finally{k(null)}},$=["All",...Array.from(new Set(b.map(e=>e.category)))];return(0,t.jsx)(i.default,{allowedRoles:["authority","admin"],children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto py-10 space-y-8 animate-in fade-in-50",children:[(0,t.jsxs)("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-slate-900 via-rose-950 to-slate-900 p-8 shadow-2xl border border-white/5",children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 p-10 opacity-10",children:(0,t.jsx)(m.AlertCircle,{className:"w-64 h-64 text-white"})}),(0,t.jsxs)("div",{className:"relative z-10 flex justify-between items-end",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-rose-500/20 rounded-lg border border-rose-500/20 backdrop-blur-sm",children:(0,t.jsx)(m.AlertCircle,{className:"w-6 h-6 text-rose-400"})}),(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-white",children:"Grievance Management"})]}),(0,t.jsx)("p",{className:"text-slate-300 max-w-xl text-lg",children:"Review, track, and resolve campus-wide issues reported by students and faculty."})]}),(0,t.jsxs)(n.Button,{onClick:P,variant:"outline",className:"bg-white/5 border-white/10 hover:bg-white/10 text-white",children:[(0,t.jsx)(v.RefreshCw,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),(0,t.jsxs)("div",{className:"aegis-card p-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,t.jsx)("div",{className:"p-2 bg-orange-500/10 rounded-lg border border-orange-500/20",children:(0,t.jsx)(x.Filter,{className:"w-5 h-5 text-orange-400"})}),(0,t.jsx)("h3",{className:"text-xl font-bold text-white",children:"Filters & Search"})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)(h.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5 transition-colors group-hover:text-primary"}),(0,t.jsx)(o.Input,{placeholder:"Search by ID, description, or location...",value:L,onChange:e=>T(e.target.value),className:"pl-12 bg-white/5 border-white/10 text-white placeholder:text-slate-500 focus:bg-white/10 transition-all text-lg h-12 rounded-xl"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-slate-300 ml-1",children:"Status"}),(0,t.jsxs)(u.Select,{value:C,onValueChange:I,children:[(0,t.jsx)(u.SelectTrigger,{className:"bg-white/5 border-white/10 text-white h-11 rounded-xl",children:(0,t.jsx)(u.SelectValue,{})}),(0,t.jsxs)(u.SelectContent,{className:"bg-slate-900 border-white/10 text-white",children:[(0,t.jsx)(u.SelectItem,{value:"All",children:"All Statuses"}),(0,t.jsx)(u.SelectItem,{value:"Submitted",children:"Submitted"}),(0,t.jsx)(u.SelectItem,{value:"Under Review",children:"Under Review"}),(0,t.jsx)(u.SelectItem,{value:"In Progress",children:"In Progress"}),(0,t.jsx)(u.SelectItem,{value:"Resolved",children:"Resolved"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-slate-300 ml-1",children:"Priority"}),(0,t.jsxs)(u.Select,{value:R,onValueChange:E,children:[(0,t.jsx)(u.SelectTrigger,{className:"bg-white/5 border-white/10 text-white h-11 rounded-xl",children:(0,t.jsx)(u.SelectValue,{})}),(0,t.jsxs)(u.SelectContent,{className:"bg-slate-900 border-white/10 text-white",children:[(0,t.jsx)(u.SelectItem,{value:"All",children:"All Priorities"}),(0,t.jsx)(u.SelectItem,{value:"High",children:"High"}),(0,t.jsx)(u.SelectItem,{value:"Medium",children:"Medium"}),(0,t.jsx)(u.SelectItem,{value:"Low",children:"Low"}),(0,t.jsx)(u.SelectItem,{value:"Urgent",children:"Urgent"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-slate-300 ml-1",children:"Category"}),(0,t.jsxs)(u.Select,{value:z,onValueChange:B,children:[(0,t.jsx)(u.SelectTrigger,{className:"bg-white/5 border-white/10 text-white h-11 rounded-xl",children:(0,t.jsx)(u.SelectValue,{})}),(0,t.jsx)(u.SelectContent,{className:"bg-slate-900 border-white/10 text-white",children:$.map(e=>(0,t.jsx)(u.SelectItem,{value:e,children:"All"===e?"All Categories":e},e))})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-white/5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(c.Badge,{variant:"outline",className:"border-white/10 bg-white/5 text-slate-400 rounded-lg px-3 py-1",children:["Total: ",b.length]}),(0,t.jsxs)("p",{className:"text-sm text-slate-500",children:["Displaying ",j.length," grievances"]})]}),("All"!==C||"All"!==R||"All"!==z||L)&&(0,t.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>{I("All"),E("All"),B("All"),T("")},className:"text-slate-400 hover:text-white hover:bg-white/5",children:"Clear Filters"})]})]})]}),N?(0,t.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,t.jsx)(d.Skeleton,{className:"h-40 w-full bg-white/5 rounded-2xl"},e))}):0===j.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 text-center aegis-card",children:[(0,t.jsx)("div",{className:"w-16 h-16 rounded-full bg-white/5 flex items-center justify-center mb-4",children:(0,t.jsx)(h.Search,{className:"w-8 h-8 text-slate-500"})}),(0,t.jsx)("h3",{className:"text-xl font-medium text-white mb-2",children:"No grievances found"}),(0,t.jsx)("p",{className:"text-slate-400 max-w-sm",children:"No grievances match your current filters. Try adjusting your search query or clearing filters."})]}):(0,t.jsx)("div",{className:"grid grid-cols-1 gap-4",children:j.map(e=>(0,t.jsx)("div",{className:"aegis-card p-6 group hover:border-slate-500/30 transition-all duration-300",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start gap-6",children:[(0,t.jsxs)("div",{className:"flex-1 space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,t.jsx)(c.Badge,{variant:"outline",className:`${(e=>{switch(e){case"Resolved":return"bg-emerald-500/10 text-emerald-400 border-emerald-500/20";case"In Progress":return"bg-blue-500/10 text-blue-400 border-blue-500/20";case"Under Review":return"bg-yellow-500/10 text-yellow-500 border-yellow-500/20";default:return"bg-slate-500/10 text-slate-400 border-slate-500/20"}})(e.status)} px-3 py-1`,children:e.status}),(0,t.jsxs)(c.Badge,{variant:"outline",className:`${(e=>{switch(e){case"High":return"bg-rose-500/10 text-rose-400 border-rose-500/20";case"Urgent":return"bg-red-600/10 text-red-500 border-red-600/20 animate-pulse";case"Medium":return"bg-orange-500/10 text-orange-400 border-orange-500/20";case"Low":return"bg-emerald-500/10 text-emerald-400 border-emerald-500/20";default:return"bg-slate-500/10 text-slate-400 border-slate-500/20"}})(e.priority)} px-3 py-1`,children:[e.priority," Priority"]}),(0,t.jsxs)("span",{className:"text-xs font-mono text-slate-500 bg-white/5 px-2 py-1 rounded border border-white/5",children:["ID: ",e.grievanceId.slice(0,8)]}),(0,t.jsxs)("span",{className:"text-xs text-slate-400 flex items-center gap-1",children:[(0,t.jsx)(g.Clock,{className:"w-3 h-3"}),e.createdAt?._seconds?new Date(1e3*e.createdAt._seconds).toLocaleDateString():"N/A"]}),e.isAnonymous&&(0,t.jsx)(c.Badge,{variant:"outline",className:"text-xs border-slate-700 bg-slate-800 text-slate-400",children:"Anonymous"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-lg font-bold text-white mb-1 group-hover:text-blue-300 transition-colors",children:[e.category," ",(0,t.jsx)("span",{className:"text-slate-500 text-sm font-normal mx-2",children:"â€¢"})," ",e.location]}),(0,t.jsx)("p",{className:"text-sm text-slate-300 line-clamp-2 max-w-4xl",children:e.description})]}),(0,t.jsx)(r.default,{href:`/grievances/${e.grievanceId}`,children:(0,t.jsxs)(n.Button,{variant:"link",className:"p-0 h-auto text-blue-400 hover:text-blue-300",children:[(0,t.jsx)(f.Eye,{className:"w-4 h-4 mr-1"}),"View Full Details"]})})]}),(0,t.jsxs)("div",{className:"flex flex-row md:flex-col gap-2 min-w-[140px] w-full md:w-auto",children:["Submitted"===e.status&&(0,t.jsxs)(n.Button,{size:"sm",variant:"outline",onClick:()=>U(e.grievanceId,"Under Review"),disabled:!!A,className:"w-full border-yellow-500/30 text-yellow-500 hover:bg-yellow-500/10 hover:text-yellow-400",children:[(0,t.jsx)(g.Clock,{className:"w-3 h-3 mr-1"}),"Review"]}),("Submitted"===e.status||"Under Review"===e.status)&&(0,t.jsx)(n.Button,{size:"sm",variant:"outline",onClick:()=>U(e.grievanceId,"In Progress"),disabled:!!A,className:"w-full border-blue-500/30 text-blue-500 hover:bg-blue-500/10 hover:text-blue-400",children:"In Progress"}),"Resolved"!==e.status&&(0,t.jsx)(n.Button,{size:"sm",onClick:()=>U(e.grievanceId,"Resolved"),disabled:!!A,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white shadow-lg shadow-emerald-900/20",children:"Resolve"})]})]})},e.grievanceId))})]})})}e.s(["default",()=>w])}]);