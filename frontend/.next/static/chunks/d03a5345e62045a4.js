(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,11870,e=>{"use strict";var t=e.i(43476),s=e.i(32341),l=e.i(18566),a=e.i(71645);e.s(["default",0,({children:e,allowedRoles:r})=>{let{user:o,loading:i,role:n}=(0,s.useAuth)(),d=(0,l.useRouter)();return((0,a.useEffect)(()=>{i||o?!i&&o&&r&&!r.includes(n||"student")&&d.push("/unauthorized"):d.push("/login")},[o,i,n,r,d]),i)?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:"Loading authentication..."}):o&&(!r||r.includes(n||"student"))?(0,t.jsx)(t.Fragment,{children:e}):null}])},2747,e=>{"use strict";var t=e.i(43476),s=e.i(75157);function l({className:e,...l}){return(0,t.jsx)("div",{className:(0,s.cn)("animate-pulse rounded-md bg-muted",e),...l})}e.s(["Skeleton",()=>l])},87130,e=>{"use strict";let t=(0,e.i(75254).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>t],87130)},84774,e=>{"use strict";var t=e.i(43476),s=e.i(71645),l=e.i(75157);let a=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{className:"w-full overflow-auto",children:(0,t.jsx)("table",{ref:a,className:(0,l.cn)("w-full caption-bottom text-sm",e),...s})}));a.displayName="Table";let r=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("thead",{ref:a,className:(0,l.cn)("[&_tr]:border-b",e),...s}));r.displayName="TableHeader";let o=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("tbody",{ref:a,className:(0,l.cn)("[&_tr:last-child]:border-0",e),...s}));o.displayName="TableBody",s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("tfoot",{ref:a,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...s})).displayName="TableFooter";let i=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("tr",{ref:a,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...s}));i.displayName="TableRow";let n=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("th",{ref:a,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...s}));n.displayName="TableHead";let d=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("td",{ref:a,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...s}));d.displayName="TableCell",s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("caption",{ref:a,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",e),...s})).displayName="TableCaption",e.s(["Table",()=>a,"TableBody",()=>o,"TableCell",()=>d,"TableHead",()=>n,"TableHeader",()=>r,"TableRow",()=>i])},40160,e=>{"use strict";let t=(0,e.i(75254).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);e.s(["Download",()=>t],40160)},81140,34620,e=>{"use strict";function t(e,s,{checkForDefaultPrevented:l=!0}={}){return function(t){if(e?.(t),!1===l||!t.defaultPrevented)return s?.(t)}}"u">typeof window&&window.document&&window.document.createElement,e.s(["composeEventHandlers",()=>t],81140);var s=e.i(71645),l=globalThis?.document?s.useLayoutEffect:()=>{};e.s(["useLayoutEffect",()=>l],34620)},35804,e=>{"use strict";var t=e.i(71645),s=e.i(34620);function l(e){let[l,a]=t.useState(void 0);return(0,s.useLayoutEffect)(()=>{if(e){a({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let s,l;if(!Array.isArray(t)||!t.length)return;let r=t[0];if("borderBoxSize"in r){let e=r.borderBoxSize,t=Array.isArray(e)?e[0]:e;s=t.inlineSize,l=t.blockSize}else s=e.offsetWidth,l=e.offsetHeight;a({width:s,height:l})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}a(void 0)},[e]),l}e.s(["useSize",()=>l])},69340,99682,e=>{"use strict";var t=e.i(71645),s=e.i(34620);t[" useEffectEvent ".trim().toString()],t[" useInsertionEffect ".trim().toString()];var l=t[" useInsertionEffect ".trim().toString()]||s.useLayoutEffect;function a({prop:e,defaultProp:s,onChange:a=()=>{},caller:r}){let[o,i,n]=function({defaultProp:e,onChange:s}){let[a,r]=t.useState(e),o=t.useRef(a),i=t.useRef(s);return l(()=>{i.current=s},[s]),t.useEffect(()=>{o.current!==a&&(i.current?.(a),o.current=a)},[a,o]),[a,r,i]}({defaultProp:s,onChange:a}),d=void 0!==e,c=d?e:o;{let s=t.useRef(void 0!==e);t.useEffect(()=>{let e=s.current;if(e!==d){let t=d?"controlled":"uncontrolled";console.warn(`${r} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}s.current=d},[d,r])}return[c,t.useCallback(t=>{if(d){let s="function"==typeof t?t(e):t;s!==e&&n.current?.(s)}else i(t)},[d,e,i,n])]}function r(e){let s=t.useRef({value:e,previous:e});return t.useMemo(()=>(s.current.value!==e&&(s.current.previous=s.current.value,s.current.value=e),s.current.previous),[e])}Symbol("RADIX:SYNC_STATE"),e.s(["useControllableState",()=>a],69340),e.s(["usePrevious",()=>r],99682)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},64659,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["ChevronDown",()=>t],64659)},40750,e=>{"use strict";var t=e.i(43476),s=e.i(71645),l=e.i(32341),a=e.i(11870),r=e.i(19455),o=e.i(87486),i=e.i(93479),n=e.i(2747),d=e.i(67489),c=e.i(55436),u=e.i(78583),m=e.i(16715),x=e.i(40160),h=e.i(87130),b=e.i(98919),f=e.i(84774);function g(){let{user:e}=(0,l.useAuth)(),[g,p]=(0,s.useState)([]),[j,N]=(0,s.useState)([]),[v,w]=(0,s.useState)(!0),[y,T]=(0,s.useState)(""),[S,A]=(0,s.useState)("All"),C=async()=>{if(e){w(!0);try{let t=await e.getIdToken(),s=await fetch("http://localhost:5000/api/admin/audit-logs",{headers:{Authorization:`Bearer ${t}`}});if(!s.ok)throw Error("Failed to fetch logs");let l=await s.json();p(l),N(l)}catch(e){console.error(e)}finally{w(!1)}}};(0,s.useEffect)(()=>{C()},[e]),(0,s.useEffect)(()=>{let e=[...g];"All"!==S&&(e=e.filter(e=>e.action===S)),y&&(e=e.filter(e=>e.userId?.toLowerCase().includes(y.toLowerCase())||e.resourceId?.toLowerCase().includes(y.toLowerCase())||e.details?.toLowerCase().includes(y.toLowerCase()))),N(e)},[S,y,g]);let R=["All",...Array.from(new Set(g.map(e=>e.action)))];return(0,t.jsx)(a.default,{allowedRoles:["admin"],children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto py-10 space-y-8 animate-in fade-in-50",children:[(0,t.jsxs)("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-indigo-50 via-slate-50 to-indigo-50 p-8 shadow-2xl border border-slate-200",children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 p-10 opacity-10",children:(0,t.jsx)(u.FileText,{className:"w-64 h-64 text-slate-900"})}),(0,t.jsxs)("div",{className:"relative z-10 flex justify-between items-end",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-indigo-500/10 rounded-lg border border-indigo-200 backdrop-blur-sm",children:(0,t.jsx)(b.Shield,{className:"w-6 h-6 text-indigo-600"})}),(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-slate-900",children:"System Audit Logs"})]}),(0,t.jsx)("p",{className:"text-slate-600 max-w-xl text-lg",children:"Detailed record of all system activities, security events, and user actions."})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)(r.Button,{onClick:C,variant:"outline",className:"bg-white border-slate-200 hover:bg-slate-50 text-slate-700",children:[(0,t.jsx)(m.RefreshCw,{className:"w-4 h-4 mr-2"}),"Refresh"]}),(0,t.jsxs)(r.Button,{onClick:()=>{let e=new Blob([["Timestamp,User ID,Action,Resource,Details",...j.map(e=>[new Date(e.timestamp?._seconds*1e3||Date.now()).toISOString(),e.userId||"N/A",e.action||"N/A",e.resourceId||"N/A",e.details||"N/A"].join(","))].join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download=`audit-logs-${new Date().toISOString()}.csv`,s.click()},disabled:0===j.length,className:"bg-indigo-600 hover:bg-indigo-700 text-white border-none shadow-lg shadow-indigo-500/20",children:[(0,t.jsx)(x.Download,{className:"w-4 h-4 mr-2"}),"Export CSV"]})]})]})]}),(0,t.jsxs)("div",{className:"aegis-card p-6 bg-white border border-slate-200 shadow-sm rounded-xl",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,t.jsx)("div",{className:"p-2 bg-blue-500/10 rounded-lg border border-blue-200",children:(0,t.jsx)(h.Filter,{className:"w-5 h-5 text-blue-600"})}),(0,t.jsx)("h3",{className:"text-xl font-bold text-slate-900",children:"Search Filters"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"md:col-span-2 relative group",children:[(0,t.jsx)(c.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5 transition-colors group-hover:text-primary"}),(0,t.jsx)(i.Input,{placeholder:"Search by user ID, resource ID, or details...",value:y,onChange:e=>T(e.target.value),className:"pl-12 bg-slate-50 border-slate-200 text-slate-900 placeholder:text-slate-400 focus:bg-white transition-all text-lg h-12 rounded-xl"})]}),(0,t.jsx)("div",{className:"space-y-2",children:(0,t.jsxs)(d.Select,{value:S,onValueChange:A,children:[(0,t.jsx)(d.SelectTrigger,{className:"bg-slate-50 border-slate-200 text-slate-900 h-12 rounded-xl",children:(0,t.jsx)(d.SelectValue,{placeholder:"Filter by Action"})}),(0,t.jsx)(d.SelectContent,{className:"bg-white border-slate-200 text-slate-900",children:R.map(e=>(0,t.jsx)(d.SelectItem,{value:e,className:"focus:bg-slate-100",children:"All"===e?"All Actions":e},e))})]})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-4 mt-6 border-t border-slate-100",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(o.Badge,{variant:"outline",className:"border-slate-200 bg-slate-50 text-slate-600 rounded-lg px-3 py-1",children:["Total: ",g.length]}),(0,t.jsxs)("p",{className:"text-sm text-slate-500",children:["Displaying ",j.length," logs"]})]}),("All"!==S||y)&&(0,t.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>{A("All"),T("")},className:"text-slate-500 hover:text-slate-900 hover:bg-slate-100",children:"Clear Filters"})]})]}),(0,t.jsx)("div",{className:"aegis-card overflow-hidden bg-white border border-slate-200 shadow-sm rounded-xl",children:v?(0,t.jsx)("div",{className:"p-6 space-y-4",children:[1,2,3,4,5].map(e=>(0,t.jsx)(n.Skeleton,{className:"h-16 w-full bg-slate-100 rounded-xl"},e))}):0===j.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 rounded-full bg-slate-50 flex items-center justify-center mb-4 border border-slate-100",children:(0,t.jsx)(u.FileText,{className:"w-8 h-8 text-slate-400"})}),(0,t.jsx)("h3",{className:"text-xl font-medium text-slate-900 mb-2",children:"No audit logs found"}),(0,t.jsx)("p",{className:"text-slate-500 max-w-sm",children:"No records match your current search criteria."})]}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(f.Table,{children:[(0,t.jsx)(f.TableHeader,{className:"bg-slate-50 border-b border-slate-200",children:(0,t.jsxs)(f.TableRow,{className:"border-none hover:bg-transparent",children:[(0,t.jsx)(f.TableHead,{className:"text-slate-600 font-semibold pl-6",children:"Timestamp"}),(0,t.jsx)(f.TableHead,{className:"text-slate-600 font-semibold",children:"User ID"}),(0,t.jsx)(f.TableHead,{className:"text-slate-600 font-semibold",children:"Action"}),(0,t.jsx)(f.TableHead,{className:"text-slate-600 font-semibold",children:"Resource"}),(0,t.jsx)(f.TableHead,{className:"text-slate-600 font-semibold",children:"Details"})]})}),(0,t.jsx)(f.TableBody,{children:j.map((e,s)=>(0,t.jsxs)(f.TableRow,{className:"border-b border-slate-100 hover:bg-slate-50 transition-colors group",children:[(0,t.jsx)(f.TableCell,{className:"pl-6 text-sm text-slate-500 font-mono",children:e.timestamp?._seconds?new Date(1e3*e.timestamp._seconds).toLocaleString():"N/A"}),(0,t.jsx)(f.TableCell,{className:"font-mono text-xs text-indigo-600",children:e.userId?.slice(0,12)||"N/A"}),(0,t.jsx)(f.TableCell,{children:(0,t.jsx)(o.Badge,{variant:"outline",className:`${{ROLE_CHANGE:"bg-blue-500/10 text-blue-600 border-blue-500/20",USER_DEACTIVATE:"bg-red-500/10 text-red-600 border-red-500/20",USER_ACTIVATE:"bg-emerald-500/10 text-emerald-600 border-emerald-500/20",STATUS_UPDATE:"bg-yellow-500/10 text-yellow-600 border-yellow-500/20",FILE_UPLOAD:"bg-purple-500/10 text-purple-600 border-purple-500/20",LOGIN:"bg-slate-500/10 text-slate-600 border-slate-500/20"}[e.action]||"bg-slate-500/10 text-slate-600 border-slate-500/20"} px-2 py-0.5 rounded text-xs font-semibold uppercase tracking-wider`,children:e.action})}),(0,t.jsx)(f.TableCell,{className:"font-mono text-xs text-slate-500 group-hover:text-slate-700 transition-colors",children:e.resourceId?.slice(0,12)||"N/A"}),(0,t.jsx)(f.TableCell,{className:"text-sm text-slate-600 max-w-md truncate",title:e.details,children:e.details||"No details"})]},s))})]})})})]})})}function p(){return(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)("div",{className:"text-slate-900 p-8 text-center",children:"Loading..."}),children:(0,t.jsx)(g,{})})}e.s(["default",()=>p])}]);