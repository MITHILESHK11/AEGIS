(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,11870,e=>{"use strict";var t=e.i(43476),s=e.i(32341),a=e.i(18566),r=e.i(71645);e.s(["default",0,({children:e,allowedRoles:l})=>{let{user:i,loading:o,role:n}=(0,s.useAuth)(),c=(0,a.useRouter)();return((0,r.useEffect)(()=>{o||i?!o&&i&&l&&!l.includes(n||"student")&&c.push("/unauthorized"):c.push("/login")},[i,o,n,l,c]),o)?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:"Loading authentication..."}):i&&(!l||l.includes(n||"student"))?(0,t.jsx)(t.Fragment,{children:e}):null}])},69074,e=>{"use strict";let t=(0,e.i(75254).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>t],69074)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},64659,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["ChevronDown",()=>t],64659)},46897,e=>{"use strict";let t=(0,e.i(75254).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["MapPin",()=>t],46897)},82458,e=>{"use strict";let t=(0,e.i(75254).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["default",()=>t])},89128,e=>{"use strict";var t=e.i(82458);e.s(["TriangleAlert",()=>t.default])},37869,e=>{"use strict";e.i(47167);var t=e.i(43476),s=e.i(71645),a=e.i(18566),r=e.i(32341),l=e.i(59141);e.i(61086);var i=e.i(27215),o=e.i(11870),n=e.i(89128),c=e.i(69074),d=e.i(43531),u=e.i(64659),h=e.i(46897);let m=(0,e.i(75254).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var x=e.i(19455);function p(){let{user:e}=(0,r.useAuth)(),p=(0,a.useRouter)(),[g,f]=(0,s.useState)(!1),[b,v]=(0,s.useState)(null),[j,y]=(0,s.useState)({category:"Infrastructure",priority:"Medium",location:"",description:"",isAnonymous:!1}),N=e=>{let{name:t,value:s}=e.target;y(e=>({...e,[t]:s}))},w=async t=>{t.preventDefault(),f(!0);try{let t="";if(b){let e=(0,i.ref)(l.storage,`grievances/${Date.now()}_${b.name}`),s=await (0,i.uploadBytes)(e,b);t=await (0,i.getDownloadURL)(s.ref)}let s=await e?.getIdToken();if(!(await fetch("http://localhost:5000/api/grievances/submit",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({...j,photoUrl:t})})).ok)throw Error("Failed to submit grievance");p.push("/grievances")}catch(e){console.error(e),alert("Error submitting grievance. Please try again.")}finally{f(!1)}};return(0,t.jsx)(o.default,{allowedRoles:["student"],children:(0,t.jsxs)("div",{className:"max-w-3xl mx-auto py-10 animate-in fade-in-50",children:[(0,t.jsxs)("div",{className:"mb-8 text-center space-y-4",children:[(0,t.jsx)("div",{className:"p-3 bg-gradient-to-br from-rose-50 to-orange-50 w-fit mx-auto rounded-2xl border border-rose-100 backdrop-blur-xl",children:(0,t.jsx)(n.TriangleAlert,{className:"w-10 h-10 text-rose-500"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-slate-900",children:"Submit a Grievance"}),(0,t.jsx)("p",{className:"text-slate-500 mt-2 max-w-lg mx-auto",children:"Found an issue on campus? Report it here and we'll track it until resolution."})]})]}),(0,t.jsxs)("div",{className:"aegis-card p-8 relative overflow-hidden bg-white border border-slate-200 shadow-sm rounded-xl",children:[(0,t.jsx)("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-rose-500 via-orange-500 to-rose-500"}),(0,t.jsxs)("form",{onSubmit:w,className:"space-y-8",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-slate-700 ml-1",children:"Category"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("select",{name:"category",value:j.category,onChange:N,className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-slate-900 appearance-none focus:outline-none focus:ring-2 focus:ring-rose-500/50 focus:border-rose-500/50 transition-all cursor-pointer",children:[(0,t.jsx)("option",{className:"bg-white text-slate-900",children:"Infrastructure"}),(0,t.jsx)("option",{className:"bg-white text-slate-900",children:"Academic"}),(0,t.jsx)("option",{className:"bg-white text-slate-900",children:"Administrative"}),(0,t.jsx)("option",{className:"bg-white text-slate-900",children:"Hostel"}),(0,t.jsx)("option",{className:"bg-white text-slate-900",children:"Transport"}),(0,t.jsx)("option",{className:"bg-white text-slate-900",children:"Other"})]}),(0,t.jsx)("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none",children:(0,t.jsx)(u.ChevronDown,{className:"w-4 h-4 text-slate-500"})})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-slate-700 ml-1",children:"Priority"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("select",{name:"priority",value:j.priority,onChange:N,className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-slate-900 appearance-none focus:outline-none focus:ring-2 focus:ring-rose-500/50 focus:border-rose-500/50 transition-all cursor-pointer",children:[(0,t.jsx)("option",{className:"bg-white text-slate-900",children:"Low"}),(0,t.jsx)("option",{className:"bg-white text-slate-900",children:"Medium"}),(0,t.jsx)("option",{className:"bg-white text-slate-900",children:"High"}),(0,t.jsx)("option",{className:"bg-white text-slate-900",children:"Urgent"})]}),(0,t.jsx)("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none",children:(0,t.jsx)(u.ChevronDown,{className:"w-4 h-4 text-slate-500"})})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-slate-700 ml-1",children:"Location"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(h.MapPin,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,t.jsx)("input",{type:"text",name:"location",required:!0,value:j.location,onChange:N,placeholder:"e.g. Library 2nd Floor, Room 301",className:"w-full bg-slate-50 border border-slate-200 rounded-xl pl-12 pr-4 py-3 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-rose-500/50 focus:border-rose-500/50 transition-all font-medium"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-slate-700 ml-1",children:"Description"}),(0,t.jsx)("textarea",{name:"description",required:!0,rows:5,value:j.description,onChange:N,placeholder:"Please provide detailed information about the issue...",className:"w-full bg-slate-50 border border-slate-200 rounded-xl p-4 text-slate-900 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-rose-500/50 focus:border-rose-500/50 transition-all resize-none"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-slate-700 ml-1",children:"Evidence (Optional)"}),(0,t.jsxs)("div",{className:"border-2 border-dashed border-slate-200 rounded-xl p-8 text-center hover:border-rose-500/30 hover:bg-slate-50 transition-all cursor-pointer group relative",children:[(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{e.target.files&&e.target.files[0]&&v(e.target.files[0])},className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3",children:[(0,t.jsx)("div",{className:"p-3 bg-slate-100 rounded-full text-slate-400 group-hover:text-rose-500 transition-colors",children:(0,t.jsx)(c.Upload,{className:"w-6 h-6"})}),(0,t.jsx)("div",{className:"text-sm text-slate-500",children:b?(0,t.jsx)("span",{className:"text-rose-500 font-medium",children:b.name}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"font-medium text-slate-700 group-hover:text-rose-600 transition-colors",children:"Click to upload"})," or drag and drop"]})}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"SVG, PNG, JPG or GIF (MAX. 5MB)"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 bg-slate-50 p-4 rounded-xl border border-slate-100",children:[(0,t.jsxs)("div",{className:"relative flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",name:"isAnonymous",id:"isAnonymous",checked:j.isAnonymous,onChange:e=>y(t=>({...t,isAnonymous:e.target.checked})),className:"peer h-5 w-5 cursor-pointer appearance-none rounded-md border border-slate-300 bg-white checked:border-rose-500 checked:bg-rose-500 transition-all"}),(0,t.jsx)(d.Check,{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-3.5 h-3.5 text-white opacity-0 peer-checked:opacity-100 pointer-events-none transition-opacity"})]}),(0,t.jsxs)("label",{htmlFor:"isAnonymous",className:"text-sm font-medium text-slate-700 cursor-pointer select-none",children:["Submit Anonymously ",(0,t.jsx)("span",{className:"text-slate-500 font-normal ml-1",children:"(Your name will be hidden from authorities)"})]})]}),(0,t.jsx)(x.Button,{type:"submit",disabled:g,className:"w-full bg-gradient-to-r from-rose-600 to-orange-600 hover:from-rose-500 hover:to-orange-500 text-white font-bold py-4 rounded-xl shadow-lg shadow-rose-500/20 disabled:opacity-50 transition-all hover:scale-[1.01] active:scale-[0.99]",children:g?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Submitting..."]}):(0,t.jsxs)("span",{className:"flex items-center gap-2",children:["Submit Grievance ",(0,t.jsx)(m,{className:"w-5 h-5"})]})})]})]})]})})}e.s(["default",()=>p],37869)}]);